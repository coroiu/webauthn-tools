"use strict";(self.webpackChunkwebauthn_tools=self.webpackChunkwebauthn_tools||[]).push([[325],{233:(N,W,B)=>{B.d(W,{Ed:()=>I});const o=4294967296,O=9007199254740992;class P{constructor(t,n){this.value=t,this.tag=n}}const I={decode:function T(S,{tagger:t,simpleValue:n,ignoreTrailingData:A}={}){let y=new DataView(S),u=new Uint8Array(S),l=0,w=function(r,d){return new P(r,d)},m=function(r){};function a(r,d){return l+=r,d}function b(r){return a(r,new Uint8Array(S,l,r))}function C(){return a(1,u[l])}function E(){return a(2,y.getUint16(l))}function D(){return a(4,y.getUint32(l))}function k(){return 255===u[l]&&(l+=1,!0)}function e(r){if(r<24)return r;if(24===r)return C();if(25===r)return E();if(26===r)return D();if(27===r)return function j(){return D()*o+D()}();if(31===r)return-1;throw new Error("Invalid length encoding")}function i(r){let d=C();if(255===d)return-1;let p=e(31&d);if(p<0||d>>5!==r)throw new Error("Invalid indefinite length element");return p}function h(r,d){for(let p=0;p<d;++p){let f=C();128&f&&(f<224?(f=(31&f)<<6|63&C(),d-=1):f<240?(f=(15&f)<<12|(63&C())<<6|63&C(),d-=2):(f=(15&f)<<18|(63&C())<<12|(63&C())<<6|63&C(),d-=3)),f<65536?r.push(f):(f-=65536,r.push(55296|f>>10),r.push(56320|1023&f))}}"function"==typeof t&&(w=t),"function"==typeof n&&(m=n);let U=function g(){let f,c,r=C(),d=r>>5,p=31&r;if(7===d)switch(p){case 25:return function K(){let r=new ArrayBuffer(4),d=new DataView(r),p=E(),f=32768&p,c=31744&p,_=1023&p;if(31744===c)c=261120;else if(0!==c)c+=114688;else if(0!==_)return(f?-1:1)*_*5.960464477539063e-8;return d.setUint32(0,f<<16|c<<13|_<<13),d.getFloat32(0)}();case 26:return function R(){return a(4,y.getFloat32(l))}();case 27:return function V(){return a(8,y.getFloat64(l))}()}if(c=e(p),c<0&&(d<2||6<d))throw new Error("Invalid length");switch(d){case 0:return c;case 1:return-1-c;case 2:if(c<0){let F=[],J=0;for(;(c=i(d))>=0;)J+=c,F.push(b(c));let Y=new Uint8Array(J),Z=0;for(f=0;f<F.length;++f)Y.set(F[f],Z),Z+=F[f].length;return Y}return b(c);case 3:let _=[];if(c<0)for(;(c=i(d))>=0;)h(_,c);else h(_,c);let G="";for(f=0;f<_.length;f+=8192)G+=String.fromCharCode.apply(null,_.slice(f,f+8192));return G;case 4:let L;if(c<0)for(L=[];!k();)L.push(g());else for(L=new Array(c),f=0;f<c;++f)L[f]=g();return L;case 5:let z={};for(f=0;f<c||c<0&&!k();++f)z[g()]=g();return z;case 6:return w(g(),c);case 7:switch(c){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:return m(c)}}}();if(l!==S.byteLength&&!A)throw new Error("Remaining bytes");return[U,l]},encode:function $(S){let y,t=new ArrayBuffer(256),n=new DataView(t),A=new Uint8Array(t),u=0;function l(e){let i=t.byteLength,h=u+e;for(;i<h;)i<<=1;if(i!==t.byteLength){let g=n;t=new ArrayBuffer(i),n=new DataView(t),A=new Uint8Array(t);let U=u+3>>2;for(let r=0;r<U;++r)n.setUint32(r<<2,g.getUint32(r<<2))}return y=e,n}function w(...e){u+=y}function a(e){w(l(1).setUint8(u,e))}function b(e){l(e.length),A.set(e,u),w()}function K(e){w(l(2).setUint16(u,e))}function R(e){w(l(4).setUint32(u,e))}function V(e){let i=e%o,h=(e-i)/o,g=l(8);g.setUint32(u,h),g.setUint32(u+4,i),w()}function E(e,i){i<24?a(e<<5|i):i<256?(a(e<<5|24),a(i)):i<65536?(a(e<<5|25),K(i)):i<4294967296?(a(e<<5|26),R(i)):(a(e<<5|27),V(i))}if(function D(e){let i;if(!1===e)return a(244);if(!0===e)return a(245);if(null===e)return a(246);if(void 0===e)return a(247);if(function s(S,t){return"function"==typeof Object.is?Object.is(S,t):S===t?0!==S||1/S==1/t:S!=S&&t!=t}(e,-0))return b([249,128,0]);switch(typeof e){case"number":if(Math.floor(e)===e){if(0<=e&&e<=O)return E(0,e);if(-O<=e&&e<0)return E(1,-(e+1))}return a(251),function m(e){w(l(8).setFloat64(u,e))}(e);case"string":let h=[];for(i=0;i<e.length;++i){let r=e.charCodeAt(i);r<128?h.push(r):r<2048?(h.push(192|r>>6),h.push(128|63&r)):r<55296||r>=57344?(h.push(224|r>>12),h.push(128|r>>6&63),h.push(128|63&r)):(r=(1023&r)<<10,r|=1023&e.charCodeAt(++i),r+=65536,h.push(240|r>>18),h.push(128|r>>12&63),h.push(128|r>>6&63),h.push(128|63&r))}return E(3,h.length),b(h);default:let g,U;if(Array.isArray(e))for(g=e.length,E(4,g),i=0;i<g;i+=1)D(e[i]);else if(e instanceof Uint8Array)E(2,e.length),b(e);else if(ArrayBuffer.isView(e))U=new Uint8Array(e.buffer),E(2,U.length),b(U);else if(e instanceof ArrayBuffer||"function"==typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)U=new Uint8Array(e),E(2,U.length),b(U);else if(e instanceof P)(function C(e,i=0){e<=255?e<24?a(e|i):(a(24|i),a(e)):e<=65535?(a(25|i),K(e)):e<=4294967295?(a(26|i),R(e)):(a(27|i),V(e))})(e.tag,192),D(e.value);else{let r=Object.keys(e);for(g=r.length,E(5,g),i=0;i<g;i+=1){let d=r[i];D(d),D(e[d])}}}}(S),"slice"in t)return t.slice(0,u);let j=new ArrayBuffer(u),k=new DataView(j);for(let e=0;e<u;++e)k.setUint8(e,n.getUint8(e));return j}}},7572:(N,W,B)=>{B.d(W,{_O:()=>x,bB:()=>o,fr:()=>O,g0:()=>I,hB:()=>H,uV:()=>S,vr:()=>T,ym:()=>$,zv:()=>s});var M=B(233);function o(t){try{return t()}catch(n){return console.error(n),`[Unable to decode; Error: ${n}]`}}function O(t){return new Uint8Array(atob(t.replace(/-/g,"+").replace(/_/g,"/")).split("").map(n=>n.charCodeAt(0)))}class H{constructor(n){this.buffer=n,this.offset=0}get remaining(){return this.buffer.length-this.offset}read(n){if(n>this.remaining)throw new Error(`Trying to read ${n} bytes, but only ${this.remaining} bytes are available`);const A=this.buffer.slice(this.offset,this.offset+n);return this.offset+=n,A}readByte(){return this.read(1)[0]}readUInt32BE(){const n=this.read(4);return n[0]<<24|n[1]<<16|n[2]<<8|n[3]}readUInt16BE(){const n=this.read(2);return n[0]<<8|n[1]}getCopyOfRemainingData(){return this.buffer.slice(this.offset)}}function s(t){return Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function x(t){return t instanceof ArrayBuffer?s(new Uint8Array(t)):t instanceof Uint8Array?s(t):Array.isArray(t)?t.map(x):"object"==typeof t?Object.fromEntries(Object.entries(t).map(([n,A])=>[n,x(A)])):t}function T(t){if(void 0===t)return;const A=String(t);return{"-65535":"RS1","-65534":"A128CTR","-65533":"A192CTR","-65532":"A256CTR","-65531":"A128CBC","-65530":"A192CBC","-65529":"A256CBC","-260":"WalnutDSA","-259":"RS512","-258":"RS384","-257":"RS256","-47":"ES256K","-46":"HSS-LMS","-45":"SHAKE256","-44":"SHA-512","-43":"SHA-384","-42":"RSAES-OAEP w/ SHA-512","-41":"RSAES-OAEP w/ SHA-256","-40":"RSAES-OAEP w/ RFC 8017 default parameters","-39":"PS512","-38":"PS384","-37":"PS256","-36":"ES512","-35":"ES384","-34":"ECDH-SS + A256KW","-33":"ECDH-SS + A192KW","-32":"ECDH-SS + A128KW","-31":"ECDH-ES + A256KW","-30":"ECDH-ES + A192KW","-29":"ECDH-ES + A128KW","-28":"ECDH-SS + HKDF-512","-27":"ECDH-SS + HKDF-256","-26":"ECDH-ES + HKDF-512","-25":"ECDH-ES + HKDF-256","-18":"SHAKE128","-17":"SHA-512/256","-16":"SHA-256","-15":"SHA-256/64","-14":"SHA-1","-13":"direct+HKDF-AES-256","-12":"direct+HKDF-AES-128","-11":"direct+HKDF-SHA-512","-10":"direct+HKDF-SHA-256","-8":"EdDSA","-7":"ES256","-6":"direct","-5":"A256KW","-4":"A192KW","-3":"A128KW",1:"A128GCM",2:"A192GCM",3:"A256GCM",4:"HMAC 256/64",5:"HMAC 256/256",6:"HMAC 384/384",7:"HMAC 512/512",10:"AES-CCM-16-64-128",11:"AES-CCM-16-64-256",12:"AES-CCM-64-64-128",13:"AES-CCM-64-64-256",14:"AES-MAC 128/64",15:"AES-MAC 256/64",24:"ChaCha20/Poly1305",25:"AES-MAC 128/128",26:"AES-MAC 256/128",30:"AES-CCM-16-128-128",31:"AES-CCM-16-128-256",32:"AES-CCM-64-128-128",33:"AES-CCM-64-128-256",34:"IV-GENERATION"}[A]??`[Unknown algorithm: ${A}]`}function $(t){const n=t instanceof Uint8Array?t:O(t);if(n.length<37)throw new Error("Authenticator data is too short");const A=new H(n);let l,y=s(A.read(32)),u=A.readByte();l={userPresence:!!(1&u),reserved1:!!(2&u),userVerification:!!(4&u),backupEligibility:!!(8&u),backupState:!!(16&u),reserved2:!!(32&u),attestationData:!!(64&u),extensionData:!!(128&u)};const m={rpIdHash:y,flags:l,counter:A.readUInt32BE(),attestedCredentialData:l.attestationData?o(()=>I(A)):void 0};return l.extensionData&&(m.extensionData=o(()=>{const a=A.getCopyOfRemainingData(),[b,K]=M.Ed.decode(a.buffer,{ignoreTrailingData:!0});return A.read(K),x(b)})),A.remaining>0&&(m.unsupportedData=s(A.read(A.remaining))),m}function I(t){if(t.remaining<76)throw new Error("The attestationData flag is set, but the remaining data is smaller than 76 bytes. Did we encounter the attestationData flag for an assertion response?");const A=function P(t){const n=s(t);return`${n.slice(0,8)}-${n.slice(8,12)}-${n.slice(12,16)}-${n.slice(16,20)}-${n.slice(20)}`}(t.read(16)),y=t.readUInt16BE();return{aaguid:A,credentialIdLength:y,credentialId:s(t.read(y)),credentialPublicKey:o(()=>{const w=t.getCopyOfRemainingData(),[m,a]=M.Ed.decode(w.buffer,{ignoreTrailingData:!0});return t.read(a),x(m)})}}function S(t){return{...t,alg:T(t.alg)}}},7325:(N,W,B)=>{B.d(W,{Y:()=>H,m:()=>O});var M=B(233),o=B(7572);function O(s){return{...s,options:{...s.options,publicKey:{...s.options.publicKey,pubKeyCredParams:(0,o.bB)(()=>s.options.publicKey.pubKeyCredParams?.map(o.uV)),excludeCredentials:(0,o.bB)(()=>s.options.publicKey.excludeCredentials?.map(o.uV))}},response:{value:{authenticatorAttachment:s.response.value.authenticatorAttachment,getClientExtensionResults:s.response.value.getClientExtensionResults,id:s.response.value.id,rawId:(0,o.zv)((0,o.fr)(s.response.value.rawId)),type:s.response.value.type,response:{attestationObject:(0,o.bB)(()=>H(s.response.value.response.attestationObject)),clientDataJSON:(0,o.bB)(()=>JSON.parse(atob(s.response.value.response.clientDataJSON))),getAuthenticatorData:(0,o.bB)(()=>(0,o.ym)(s.response.value.response.getAuthenticatorData)),getPublicKey:(0,o.bB)(()=>(0,o.zv)((0,o.fr)(s.response.value.response.getPublicKey))),getPublicKeyAlgorithm:(0,o.vr)(s.response.value.response.getPublicKeyAlgorithm),getTransports:s.response.value.response.getTransports}}}}}function H(s){const P=s instanceof Uint8Array?s:(0,o.fr)(s),x=M.Ed.decode(P.buffer)[0];return console.log({cborMap:x,recursiveConvertArrayBufferToHexString:o._O}),{...x,attStmt:(0,o._O)(x.attStmt),authData:(0,o.ym)(x.authData)}}}}]);